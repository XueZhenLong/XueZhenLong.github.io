<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>MyBatis缓存 - ❤️Xue&#039;s Blog❤️</title><meta description="@Author: Xue ZhenLong @Address: Beijing province, China"><meta property="og:type" content="blog"><meta property="og:title" content="MyBatis缓存"><meta property="og:url" content="https://xuezhenlong.github.io/2021/01/17/Mybatis%E7%BC%93%E5%AD%98/"><meta property="og:site_name" content="❤️Xue&#039;s Blog❤️"><meta property="og:description" content="@Author: Xue ZhenLong @Address: Beijing province, China"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://xuezhenlong.github.io/gallery/8.20c.jpg"><meta property="article:published_time" content="2021-01-17T09:49:20.000Z"><meta property="article:modified_time" content="2021-01-18T12:05:21.609Z"><meta property="article:author" content="XueZhenLong"><meta property="article:tag" content="Mybatis"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/gallery/8.20c.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xuezhenlong.github.io/2021/01/17/Mybatis%E7%BC%93%E5%AD%98/"},"headline":"❤️Xue's Blog❤️","image":["https://xuezhenlong.github.io/gallery/8.20c.jpg"],"datePublished":"2021-01-17T09:49:20.000Z","dateModified":"2021-01-18T12:05:21.609Z","author":{"@type":"Person","name":"XueZhenLong"},"description":"@Author: Xue ZhenLong @Address: Beijing province, China"}</script><link rel="canonical" href="https://xuezhenlong.github.io/2021/01/17/Mybatis%E7%BC%93%E5%AD%98/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-3-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas><script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script type="text/javascript" src="/js/fireworks.js"></script><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">❤️Xue&#039;s Blog❤️</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/archives">时间轴</a><a class="navbar-item" href="/categories">毫无乱用的按钮...</a><a class="navbar-item" href="/categories">哈哈哈,欢迎你来到我的blog!!</a><a class="navbar-item" href="/categories">小小薛是全世界最厉害的人!</a><a class="navbar-item" href="/categories">小小薛是全世界最厉害的人!!</a><a class="navbar-item" href="/categories">小小薛是全世界最厉害的人!!!</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="thumbnail" src="/gallery/8.20c.jpg" alt="MyBatis缓存"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-17T09:49:20.000Z" title="2021-01-17T09:49:20.000Z">2021-01-17</time><span class="level-item">22 分钟 读完 (大约 3233 个字)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">MyBatis缓存</h1><div class="content"><p>@Author: Xue ZhenLong @Address: Beijing province, China </p>
<a id="more"></a>

<h1 id="MyBatis缓存"><a href="#MyBatis缓存" class="headerlink" title="MyBatis缓存"></a>MyBatis缓存</h1><p>MyBatis共有两级缓存: sqlSession级别的缓存， 一级缓存是一直开启的。</p>
<p>##一级缓存:(本地缓存)</p>
<p>　　MyBatis对缓存提供支持，但是在没有配置的默认情况下，它只开启一级缓存，一级缓存只是相对于同一个SqlSession而言。所以在参数和SQL完全一样的情况下，我们使用同一个SqlSession对象调用一个Mapper方法，往往只执行一次SQL，因为使用SelSession第一次查询后，MyBatis会将其放在缓存中，以后再查询的时候，如果没有声明需要刷新，并且缓存没有超时的情况下，SqlSession都会取出当前缓存的数据，而不会再次发送SQL到数据库。（与数据库同一次会话期间查询到的数据会放在本地缓存中，以后如果需要获取相同的数据,直接从缓存中拿,没有必要再去查询数据库）</p>
<p><strong>1、一级缓存的生命周期有多长？</strong></p>
<p>　　a、MyBatis在开启一个数据库会话时，会创建一个新的SqlSession对象，SqlSession对象中会有一个新的Executor对象。Executor对象中持有一个新的PerpetualCache对象；当会话结束时，SqlSession对象及其内部的Executor对象还有PerpetualCache对象也一并释放掉。</p>
<p>　　b、如果SqlSession调用了close()方法，会释放掉一级缓存PerpetualCache对象，一级缓存将不可用。</p>
<p>　　c、如果SqlSession调用了clearCache()，会清空PerpetualCache对象中的数据，但是该对象仍可使用。</p>
<p>　　d、SqlSession中执行了任何一个update操作(update()、delete()、insert()) ，都会清空PerpetualCache对象的数据，但是该对象可以继续使用</p>
<p> <strong>2、怎么判断某两次查询是完全相同的查询？</strong></p>
<p>　　Mybatis认为，对于两次查询，如果以下条件都完全一样，那么就认为它们是完全相同的两次查询。</p>
<p>　　2.1 传入的statementId</p>
<p>　　2.2 查询时要求的结果集中的结果范围</p>
<p>　　2.3. 这次查询所产生的最终要传递给JDBC java.sql.Preparedstatement的Sql语句字符串（boundSql.getSql() ）</p>
<p>　　2.4 传递给java.sql.Statement要设置的参数值</p>
<p><strong>3、一级缓存的失效情况:</strong></p>
<p>​                  1.sqlSession不同<br>​                  2.sqlSession相同,但是查询条件不同  (当前一级缓存中没有信息)<br>​                  3.sqlSession相同,但是两次查询期间实现了增删改操作(这次增删改可能对数据有影响)<br>​                  4.sqlSession相同,手动清除了一级缓存(缓存清空)</p>
<h2 id="二级缓存-全局缓存"><a href="#二级缓存-全局缓存" class="headerlink" title="二级缓存:(全局缓存)"></a>二级缓存:(全局缓存)</h2><p>​                 MyBatis的二级缓存是Application级别的缓存，它可以提高对数据库查询的效率，以提高应用的性能 </p>
<p>​              基于namespace级别的缓存:一个namespace对应一个二级缓存</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>SqlSessionFactory层面上的二级缓存默认是不开启的，二级缓存的开席需要进行配置，实现二级缓存的时候，MyBatis要求返回的POJO必须是可序列化的。 也就是要求实现Serializable接口，配置方法很简单，只需要在映射XML文件配置就可以开启缓存了<cache/>，如果我们配置了二级缓存就意味着：</p>
<ul>
<li>映射语句文件中的所有select语句将会被缓存。</li>
<li>映射语句文件中的所欲insert、update和delete语句会刷新缓存。</li>
<li>缓存会使用默认的Least Recently Used（LRU，最近最少使用的）算法来收回。</li>
<li>根据时间表，比如No Flush Interval,（CNFI没有刷新间隔），缓存不会以任何时间顺序来刷新。</li>
<li>缓存会存储列表集合或对象(无论查询方法返回什么)的1024个引用</li>
<li>缓存会被视为是read/write(可读/可写)的缓存，意味着对象检索不是共享的，而且可以安全的被调用者修改，不干扰其他调用者或线程所做的潜在修改。</li>
</ul>
<p>###工作机制:</p>
<p>​                  1.一个会话,查询一条数据,这个数据就会被放在当前会话的一级缓存中;<br>​                  2.如果会话关闭:一级缓存中的数据会被保存到二级缓存中;新的会话查询信息,就可以参照二级缓存中.<br>​                  3.sqlSession ==&gt;EmployeeMapper==&gt;Employee<br>​                                  DepartmentMapper==&gt;Department<br>​                       不同namespace查出的数据会放在自己对应的缓存中(map)</p>
<p>​                      效果:数据会从二级缓存中获取<br>​        (注意: 查出的数据都会被默认先放在一级缓存中,只有会话提交或者关闭以后,一级缓存中的数据才会转移到二级缓存)</p>
<h3 id="二级缓存的使用"><a href="#二级缓存的使用" class="headerlink" title="二级缓存的使用:"></a>二级缓存的使用:</h3><p>####二级缓存使用步骤：</p>
<p>​                        1.mybatis-config.xml Setting 中的 cacheEnabled–true<br>​                        2.去mapper.xml中配置使用二级缓存 <cache></cache><br>​                        3.我们POJO需要实现序列化接口</p>
<h4 id="缓存标签的属性设置："><a href="#缓存标签的属性设置：" class="headerlink" title="缓存标签的属性设置："></a>缓存标签的属性设置：</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">"LRU"</span> <span class="attr">flushInterval</span>=<span class="string">"60000"</span> <span class="attr">readOnly</span>=<span class="string">"false"</span> <span class="attr">size</span>=<span class="string">"1024"</span>&gt;</span>    </span><br><span class="line">    cache 标签有多个属性，一起来看一些这些属性分别代表什么意义            </span><br><span class="line">    eviction: 缓存回收策略，有这几种回收策略            </span><br><span class="line">                LRU - 最近最少回收，移除最长时间不被使用的对象            </span><br><span class="line">                FIFO - 先进先出，按照缓存进入的顺序来移除它们            </span><br><span class="line">                SOFT - 软引用，移除基于垃圾回收器状态和软引用规则的对象            </span><br><span class="line">                WEAK - 弱引用，更积极的移除基于垃圾收集器和弱引用规则的对象           </span><br><span class="line">                默认是 LRU 最近最少回收策略           </span><br><span class="line">    flushInterval 缓存刷新间隔，缓存多长时间刷新一次，默认不清空，设置一个毫秒值           </span><br><span class="line">    readOnly:是否只读：</span><br><span class="line">                     true 只读，MyBatis 认为所有从缓存中获取数据的操作都是只读操作，不会修改数据。MyBatis 为了加快获取数据，直接就会将数据在缓存中的引用交给用户。不安全，速度快。读写(默认)：MyBatis 觉得数据可能会被修改                   false 非只读:mybatis觉得回去的数据可能会被修改 MyBatis会利用序列化&amp;反序列的技术克隆一份新的数据给你,安全,速度慢            </span><br><span class="line">    size : 缓存存放多少个元素            </span><br><span class="line">    type: 指定自定义缓存的全类名(实现Cache 接口即可)           </span><br><span class="line">    blocking： 若缓存中找不到对应的key，是否会一直blocking，直到有对应的数据进入缓存。</span><br></pre></td></tr></table></figure>

<hr>
<p>##和缓存有关的设置/属性:</p>
<p>​                 1.<setting name="cacheEnabled" value="false"/> :关闭缓存操作只是关闭二级缓存,一级缓存一直可用<br>​                 2.每个select标签都有useCache=”true”<br>​                                  false:关闭的是二级缓存</p>
<p>​                                  重点:<br>​                 3.每个增删改查标签的:flushCache=”true”增删改查执行完成后就会清除缓存:<br>​                            测试:flushCache=”true”一级缓存和二级缓存都会被清除<br>​                 4.sqlSession.clearCache(); 只是清除当前session的一级缓存与二级缓存无关<br>​                 5.localCacheScope:本地缓存作用域:(一级缓存SESSION);当前会话的所有数据<br>​                                  STATEMENT:可以禁用一级缓存;</p>
<h2 id="第三方缓存整合"><a href="#第三方缓存整合" class="headerlink" title="第三方缓存整合:"></a>第三方缓存整合:</h2><pre><code>         例如：EhcacheCache</code></pre>
<p>​             1.导入第三方缓存包<br>​              2.导入与第三方缓存整合的适配包:官方有<br>​              3.mapper.xml中使用自定义缓存<br>​           <cache type="org.mybatis.caches.ehcache.EhcacheCache"></cache></p>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p><strong>mybatis-config.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"src/config/dbconfig.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        开启驼峰命名法至关重要!!!--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        显式的指定每个我们需要修改的配置的值,及时他是默认的.防止版本更新带来的问题--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        延迟加载的设置,当我们需要的时候再执行--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        二级缓存--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"src.mybatis.bean.Employee"</span> <span class="attr">alias</span>=<span class="string">"emp"</span>&gt;</span><span class="tag">&lt;/<span class="name">typeAlias</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;d.url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;d.username&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;d.password&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;d.driver&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"src/config/EmployeeMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>EmployeeMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">namespace:名称空间;指定为几口的全类名;</span></span><br><span class="line"><span class="comment">id:唯一标识</span></span><br><span class="line"><span class="comment">resultType: 返回值类型</span></span><br><span class="line"><span class="comment">#&#123;id&#125; : 从传递过来的参数中取id值</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"src.mybatis.dao.EmployeeMapper"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;cache eviction="LRU" flushInterval="60000" readOnly="false" size="1024"&gt;</span></span><br><span class="line"><span class="comment">    cache 标签有多个属性，一起来看一些这些属性分别代表什么意义</span></span><br><span class="line"><span class="comment">            eviction: 缓存回收策略，有这几种回收策略</span></span><br><span class="line"><span class="comment">            LRU - 最近最少回收，移除最长时间不被使用的对象</span></span><br><span class="line"><span class="comment">            FIFO - 先进先出，按照缓存进入的顺序来移除它们</span></span><br><span class="line"><span class="comment">            SOFT - 软引用，移除基于垃圾回收器状态和软引用规则的对象</span></span><br><span class="line"><span class="comment">            WEAK - 弱引用，更积极的移除基于垃圾收集器和弱引用规则的对象</span></span><br><span class="line"><span class="comment">            默认是 LRU 最近最少回收策略</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            flushInterval 缓存刷新间隔，缓存多长时间刷新一次，默认不清空，设置一个毫秒值</span></span><br><span class="line"><span class="comment">            readOnly:</span></span><br><span class="line"><span class="comment">                是否只读；</span></span><br><span class="line"><span class="comment">                    true 只读，MyBatis 认为所有从缓存中获取数据的操作都是只读操作，不会修改数据。</span></span><br><span class="line"><span class="comment">                    MyBatis 为了加快获取数据，直接就会将数据在缓存中的引用交给用户。</span></span><br><span class="line"><span class="comment">                    不安全，速度快。读写(默认)：MyBatis 觉得数据可能会被修改</span></span><br><span class="line"><span class="comment">                    false 非只读:mybatis觉得回去的数据可能会被修改</span></span><br><span class="line"><span class="comment">                    MyBatis会利用序列化&amp;反序列的技术克隆一份新的数据给你,安全,速度慢</span></span><br><span class="line"><span class="comment">            size : 缓存存放多少个元素</span></span><br><span class="line"><span class="comment">            type: 指定自定义缓存的全类名(实现Cache 接口即可)</span></span><br><span class="line"><span class="comment">            blocking： 若缓存中找不到对应的key，是否会一直blocking，直到有对应的数据进入缓存。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">"org.mybatis.caches.ehcache.EhcacheCache"</span>&gt;</span><span class="tag">&lt;/<span class="name">cache</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"emp"</span>&gt;</span></span><br><span class="line">        select * from tbl_employee where id = #&#123;id&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>Employee. Class</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 〈员工类〉</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XueZhenLonG</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021/1/15</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Alias</span>(<span class="string">"emp"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">    <span class="keyword">private</span> Department dept;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>EmployeeMapper接口</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Employee <span class="title">getEmpById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MybatisCacheTest</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> src.mybatis.test;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> src.mybatis.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> src.mybatis.dao.EmployeeMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 〈mybatis缓存的学习测试〉</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XueZhenLonG</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2021/1/16</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.0.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisCacheTest</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试一级缓存</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFirstLevelCache</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1.根据xml配置文件(全局配置文件)创建一个SqlSessionFactory对象</span></span><br><span class="line">        String resource = <span class="string">"src/config/mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory =</span><br><span class="line">                <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.获取sqlSession实例,能够执行已经映射的sql语句</span></span><br><span class="line">        <span class="comment">//sql的唯一标识:statement Unique identifier matching the statement</span></span><br><span class="line">        <span class="comment">//执行sql要用的参数</span></span><br><span class="line">        SqlSession openSession = sqlSessionFactory.openSession();</span><br><span class="line">        SqlSession openSession1 = sqlSessionFactory.openSession();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            EmployeeMapper mapper = openSession.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            EmployeeMapper mapper1 = openSession1.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            Employee emp1 = mapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">            System.out.println(emp1);</span><br><span class="line"></span><br><span class="line"><span class="comment">//            通过日志信息我们可以看到就发送了一个sql语句  表名存在一级缓存</span></span><br><span class="line">            Employee emp2 = mapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">            System.out.println(emp2);</span><br><span class="line">            System.out.print(<span class="string">"sqlSession相同的情况下:"</span>);</span><br><span class="line">            System.out.println(emp1 == emp2); <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//            一级缓存的失效情况:</span></span><br><span class="line"><span class="comment">//            1.sqlSession不同</span></span><br><span class="line">            Employee emp3 = mapper1.getEmpById(<span class="number">1</span>);</span><br><span class="line">            System.out.print(<span class="string">"sqlSession不同的情况下:"</span>);</span><br><span class="line">            System.out.println(emp3 ==emp1);</span><br><span class="line"><span class="comment">//            2.sqlSession相同,查询条件不同(当前一级缓存中没有信息)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//            3.sqlSession相同,但是两次查询期间实现了增删改操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//            4.sqlSession相同,手动清除了一级缓存(缓存清空)</span></span><br><span class="line">            openSession.clearCache();</span><br><span class="line">            Employee emp4 = mapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">            System.out.print(<span class="string">"sqlSession相同的情况下,但是清除过缓存:"</span>);</span><br><span class="line">            System.out.println(emp1 ==emp4);</span><br><span class="line"></span><br><span class="line">            openSession1.commit();</span><br><span class="line">            openSession.commit();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            openSession.close();</span><br><span class="line">            openSession1.close();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//一级缓存的测试结果</span></span><br><span class="line">    Employee&#123;id=<span class="number">1</span>, lastName=<span class="string">'tom'</span>, email=<span class="string">'tom@qq.com'</span>, gender=<span class="string">'W'</span>, dept=<span class="keyword">null</span>&#125;</span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">641</span> Cache Hit Ratio [src.mybatis.dao.EmployeeMapper]: <span class="number">0.0</span>  (LoggingCache.java:<span class="number">60</span>) </span><br><span class="line">    Employee&#123;id=<span class="number">1</span>, lastName=<span class="string">'tom'</span>, email=<span class="string">'tom@qq.com'</span>, gender=<span class="string">'W'</span>, dept=<span class="keyword">null</span>&#125;</span><br><span class="line">    sqlSession相同的情况下:<span class="keyword">true</span></span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">641</span> Cache Hit Ratio [src.mybatis.dao.EmployeeMapper]: <span class="number">0.0</span>  (LoggingCache.java:<span class="number">60</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">645</span> ==&gt;  Preparing: select * from tbl_employee where id = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">645</span> ==&gt; Parameters: <span class="number">1</span>(Integer)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">646</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    sqlSession不同的情况下:<span class="keyword">false</span></span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">647</span> Cache Hit Ratio [src.mybatis.dao.EmployeeMapper]: <span class="number">0.0</span>  (LoggingCache.java:<span class="number">60</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">647</span> ==&gt;  Preparing: select * from tbl_employee where id = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">647</span> ==&gt; Parameters: <span class="number">1</span>(Integer)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">648</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    sqlSession相同的情况下,但是清除过缓存:<span class="keyword">false</span></span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">40</span>,<span class="number">648</span> put added <span class="number">0</span> <span class="function">on <span class="title">heap</span>  <span class="params">(Segment.java:<span class="number">425</span>)</span> </span></span><br><span class="line"><span class="function">    DEBUG 01-17 18:23:40,650 put added 0 on <span class="title">heap</span>  <span class="params">(Segment.java:<span class="number">425</span>)</span> </span></span><br><span class="line"><span class="function">    DEBUG 01-17 18:23:40,650 put updated, deleted 0 on <span class="title">heap</span>  <span class="params">(Segment.java:<span class="number">453</span>)</span> </span></span><br><span class="line"><span class="function">    <span class="comment">/**</span></span></span><br><span class="line"><span class="function"><span class="comment">     * 测试二级缓存</span></span></span><br><span class="line"><span class="function"><span class="comment">     * @throws IOException</span></span></span><br><span class="line"><span class="function"><span class="comment">     */</span></span></span><br><span class="line"><span class="function">    @Test</span></span><br><span class="line"><span class="function">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSecondLevelCache</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1.根据xml配置文件(全局配置文件)创建一个SqlSessionFactory对象</span></span><br><span class="line">        String resource = <span class="string">"src/config/mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory =</span><br><span class="line">                <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        <span class="comment">//2.获取sqlSession实例,能够执行已经映射的sql语句</span></span><br><span class="line">        <span class="comment">//sql的唯一标识:statement Unique identifier matching the statement</span></span><br><span class="line">        <span class="comment">//执行sql要用的参数</span></span><br><span class="line">        SqlSession openSession = sqlSessionFactory.openSession();</span><br><span class="line">        SqlSession openSession1 = sqlSessionFactory.openSession();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            EmployeeMapper mapper = openSession.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            EmployeeMapper mapper1 = openSession1.getMapper(EmployeeMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">            Employee emp = mapper.getEmpById(<span class="number">1</span>);</span><br><span class="line">            System.out.println(emp);</span><br><span class="line">            openSession.close();</span><br><span class="line">            <span class="comment">//第二次查询是从二级缓存中拿到的数据,并没有发送新的sql</span></span><br><span class="line">            Employee emp1 = mapper1.getEmpById(<span class="number">1</span>);</span><br><span class="line">            System.out.println(emp1);</span><br><span class="line">            openSession1.close();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//二级缓存测试的结果</span></span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">33</span>,<span class="number">000</span> ==&gt;  Preparing: select * from tbl_employee where id = ?  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">33</span>,<span class="number">017</span> ==&gt; Parameters: <span class="number">1</span>(Integer)  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">33</span>,<span class="number">026</span> &lt;==      Total: <span class="number">1</span>  (BaseJdbcLogger.java:<span class="number">137</span>) </span><br><span class="line">    Employee&#123;id=<span class="number">1</span>, lastName=<span class="string">'tom'</span>, email=<span class="string">'tom@qq.com'</span>, gender=<span class="string">'W'</span>, dept=<span class="keyword">null</span>&#125;</span><br><span class="line">    DEBUG <span class="number">01</span>-<span class="number">17</span> <span class="number">18</span>:<span class="number">24</span>:<span class="number">33</span>,<span class="number">027</span> put added <span class="number">0</span> <span class="function">on <span class="title">heap</span>  <span class="params">(Segment.java:<span class="number">425</span>)</span> </span></span><br><span class="line"><span class="function">    DEBUG 01-17 18:24:33,029 Cache Hit Ratio [src.mybatis.dao.EmployeeMapper]: 0.5  <span class="params">(LoggingCache.java:<span class="number">60</span>)</span> </span></span><br><span class="line"><span class="function">    Employee</span>&#123;id=<span class="number">1</span>, lastName=<span class="string">'tom'</span>, email=<span class="string">'tom@qq.com'</span>, gender=<span class="string">'W'</span>, dept=<span class="keyword">null</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Mybatis/">Mybatis</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/Alipay.png" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/Wechatpay.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/01/18/SpringMVC_HelloWorld/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">SpringMVC_HelloWorld</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/01/17/%E5%B0%8F%E5%B0%8F%E8%96%9B%E7%9A%84%E5%8D%9A%E5%AE%A2/"><span class="level-item">我的博客建成日记</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "Kf29TjOBA0BnSj1Kk4TyTEht-gzGzoHsz",
            appKey: "TTK55XlttoaVbOnkdkn79F8k",
            placeholder: "❤️一起来快活呀❤️",
            avatar: "retro",
            
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "zh-CN",
            visitor: true,
            
            
            
            
            
            enableQQ: true,
            requiredFields: ["nick"],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="XueZhenLong"></figure><p class="title is-size-4 is-block line-height-inherit">XueZhenLong</p><p class="is-size-6 is-block">快乐的小小薛.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China  Beijing</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">8</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/XueZhenLong" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/XueZhenLong"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="QQ" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=2502486423&amp;website=www.oicqzone.com"><i class="fab fa-qq"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://snailclimb.gitee.io/javaguide/#/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">JavaGuide</span></span><span class="level-right"><span class="level-item tag">snailclimb.gitee.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://www.imaegoo.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">iMaeGoo</span></span><span class="level-right"><span class="level-item tag">www.imaegoo.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://www.stringbug.com/message/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Lee Hua</span></span><span class="level-right"><span class="level-item tag">www.stringbug.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JDBC/"><span class="tag">JDBC</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mybatis/"><span class="tag">Mybatis</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringMVC/"><span class="tag">SpringMVC</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java-web/"><span class="tag">java web</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">学习笔记</span><span class="tag is-grey-lightest">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"><span class="tag">学习路线</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex" href="#MyBatis缓存"><span class="mr-2">1</span><span>MyBatis缓存</span></a><ul class="menu-list"><li><a class="is-flex" href="#二级缓存-全局缓存"><span class="mr-2">1.1</span><span>二级缓存:(全局缓存)</span></a></li><li><a class="is-flex" href="#简介"><span class="mr-2">1.2</span><span>简介</span></a><ul class="menu-list"><li><a class="is-flex" href="#缓存标签的属性设置："><span class="mr-2">1.2.1</span><span>缓存标签的属性设置：</span></a></li></ul></li><li><a class="is-flex" href="#第三方缓存整合"><span class="mr-2">1.3</span><span>第三方缓存整合:</span></a></li><li><a class="is-flex" href="#实践"><span class="mr-2">1.4</span><span>实践</span></a></li></ul></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><a class="media-left" href="/2021/01/18/SpringMVC_HelloWorld/"><p class="image is-64x64"><img class="thumbnail" src="/gallery/test1.jpg" alt="SpringMVC_HelloWorld"></p></a><div class="media-content size-small"><p><time dateTime="2021-01-18T11:39:16.000Z">2021-01-18</time></p><p class="title is-6"><a class="link-muted" href="/2021/01/18/SpringMVC_HelloWorld/">SpringMVC_HelloWorld</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2021/01/17/Mybatis%E7%BC%93%E5%AD%98/"><p class="image is-64x64"><img class="thumbnail" src="/gallery/8.20c.jpg" alt="MyBatis缓存"></p></a><div class="media-content size-small"><p><time dateTime="2021-01-17T09:49:20.000Z">2021-01-17</time></p><p class="title is-6"><a class="link-muted" href="/2021/01/17/Mybatis%E7%BC%93%E5%AD%98/">MyBatis缓存</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2021/01/17/%E5%B0%8F%E5%B0%8F%E8%96%9B%E7%9A%84%E5%8D%9A%E5%AE%A2/"><p class="image is-64x64"><img class="thumbnail" src="/gallery/test1.jpg" alt="我的博客建成日记"></p></a><div class="media-content size-small"><p><time dateTime="2021-01-17T08:56:18.656Z">2021-01-17</time></p><p class="title is-6"><a class="link-muted" href="/2021/01/17/%E5%B0%8F%E5%B0%8F%E8%96%9B%E7%9A%84%E5%8D%9A%E5%AE%A2/">我的博客建成日记</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2020/08/22/HTML%E5%9F%BA%E7%A1%80/"><p class="image is-64x64"><img class="thumbnail" src="/gallery/8.22.png" alt="HTML基础"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-22T14:22:49.374Z">2020-08-22</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/22/HTML%E5%9F%BA%E7%A1%80/">HTML基础</a></p><p class="is-uppercase"></p></div></article><article class="media"><a class="media-left" href="/2020/08/20/JDBC-DBUtils/"><p class="image is-64x64"><img class="thumbnail" src="/gallery/8.20b.png" alt="Apache-DBUtils实现CRUD操作"></p></a><div class="media-content size-small"><p><time dateTime="2020-08-20T10:48:07.428Z">2020-08-20</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/20/JDBC-DBUtils/">Apache-DBUtils实现CRUD操作</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">❤️Xue&#039;s Blog❤️</a><p class="size-small"><span>&copy; 2021 XueZhenLong</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv"><span id="busuanzi_container_site_pv" > ❤️小薛薛的博客被访问了 <span id="busuanzi_value_site_pv"></span> 次 </span> , <span id="busuanzi_container_site_uv" >| 您是第 <span id="busuanzi_value_site_uv"></span> 个到访的客人,感谢您的到来❤️ </span></span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://xuezhenlong.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script src="/js/imaegoo/universe.js"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>